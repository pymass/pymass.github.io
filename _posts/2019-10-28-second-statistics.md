---
published: true
layout: single
title: "통계학 정리 (2)"
category: Statistics
comments: true
toc: true
toc_sticky: true 
---

지난 포스팅에서 1부 1~2주차의 내용을 정리하였다.

이번에는 3~4주차 내용을 정리한다. 참고로, 강좌는 총 3부까지 있다.

<br/>

# 3.1 상관관계

- 결합분포(joint distribution) : 두 변수 사이의 상호관계를 보여준다.
- 산포도(scatter plot) : 두 변수 사이의 관계를 살펴보기 위해 산포도를 이용한다.
  - 설명변수는 x로 표기하고 가로축에 표시
  - 피설명변수는 y로 표기하고 세로축에 표시
  - 가로로 보면 대략 95%의 점들이 x평균점을 기준으로 ±2SDx 이내에 위치한다.
  - 세로로 보면 대략 95%의 점들이 y평균점을 기준으로 ±2SDy 이내에 위치한다.
  - x의 평균과 표준편차, y의 평균과 표준편차는 x와 y의 분포를 따로따로 요약한다.

<br/>

**상관계수**

상관계수는 두 변수간 <u>선형관계의 방향과 강도</u> 측정 (평균과 표준편차가 동일해도 선형관계의 방향과 강도가 다를 수 있기 때문이다.)

<img src="https://i.ibb.co/JjbZgnS/correlation-coefficient.png" alt="correlation-coefficient" border="0">

<br/>

- 이변량 자료의 요약 통계량
  - x의 평균과 표준편차
  - y의 평균과 표준편차
  - x와 y간 상관계수 (correlation coefficient) : r로 표기

<br/>

- 상관계수의 특징
  - 범위 : -1  ≤ r  ≤ 1
  - 상관계수 +1 또는 -1 이면 완전상관(perfect correlation)
    - 모든 점들이 정확히 하나의 선 위에 위치
  - 양의 상관관계이면 점의 분포가 우상향
  - 음의 상관관계이면 점의 분포가 우하향
  - 두 변수의 표준편차가 모두 0이면 상관계수를 정의할 수 없음
  - 두 변수 중 어느 한 변수만의 표준편차가 0이면 상관계수는 0
  - 상관계수는 단위를 갖지 않는다. 즉, 측정단위와 독립적으로 정의됨
    - 하나의 변수가 취하는 모든 값에 상수를 더하거나 빼는 변환을 해도 상관계수는 변하지 않는다.
    - 하나의 변수가 취하는 모든 값에 양의 상수를 곱하거나 양의 상수로 나누는 변환을 해도 상관계수는 변하지 않는다.
  - 상관계수는 방향성을 갖지 않음. 즉 x와 y의 상관계수는 y와 x의 상관계수와 같다.

<br/>

- 상관계수가 유용하지 않은 경우
  - 이탈값(outlier)이 존재하는 경우
  - 두 변수간 관계가 비선형인 경우

<br/>

# 3.2 상관관계와 회귀직선

- 변수 변환 : 적절한 변수변환을 통하여 (x,y)간 존재하는 비선형 관계를 (x, ln(x))간 선형관계로 근사시킴

<br/>

**상관관계와 실제 관계**

- 비율이나 평균의 자료로부터 구한 상관관계는 종종 실제의 관계를 과장
- 지역이나 국가 등 집단의 자료로부터 구한 상관계수는 개개인에게 적용되는 선형관계를 과장할 가능성이 있음
- 상관계수가 곧바로 인과관계는 아니다

<br/>

# 3.3 회귀분석

- 회귀분석(regression analysis)은 집단별 평균을 분석하는 통계적 방법
- 집단을 구분하는 분류지표가 한 개인지, 둘 또는 그 이상인지에 따라 단순회귀분석과 중회귀분석으로 나누어진다
- y의 x에 대한 회귀직선은 각각의 x값에 대응하는 y의 평균값을 추정
- x값이 x평균값에서 1SDx 증가할 때 y값은 y평균값에서 r*SDy 증가 (r:상관계수)
- 회귀직선은 <u>평균의 그래프를 하나의 직선</u>으로 근사 시킨 것
- 평균의 그래프가 비선형이면 회귀직선으로의 선형 근사는 부적절

<br/>

- 평균으로의 회귀 : 확률 오차가 존재하기 때문에 평균으로 회귀한다.

- 회귀오류 : 회귀효과를 무언가 중요한 효과로 착각하는 것(상관관계 != 인과관계)
- 관찰된 점수 = 실제 실력 + 확률 오차

<br/>

# 4.1 회귀직선의 오차

- 제곱근-평균-제곱 오차 (RMSE)
  - 실제 값과 예측치의 차이가 어느 정도 될지 알려줌
  - 추정의 표준오차(standard error of estimate) 또는 회귀의 표준오차(standard error of regression)라고도 불림

<br/>

- 추정오차
  - 실제 몸무게 - 예측된 몸무게
  - 일반적으로 잔차(residual)라고 부른다
  - 전반적인 크기는 제곱근-평균-제곱(RMS) 방식으로 측정한다.

<br/>

- RMSE의 계산
  - 분모에 표본크기가 아닌 자유도가 사용되었다.
  - 추정오차 계산의 기준은 회귀직선인데 이는 <u>절편과 기울기의 두 추정치에 의해 결정</u>되므로 <u>자유도는 2만큼 감소</u>

<br/>

- 회귀직선과 RMSE
  - 회귀직선은 x값에 따라 분류된 <u>부분집단 별로 자료의 중심</u>을 알려준다
  - RMSE는 <u>개별 관측치가</u> 그가 속한 준거집단의 <u>평균으로부터 떨어진 정도</u>를 대략적으로 알려준다
  - <u>회귀직선과 RMSE를 알면</u> 평균과 표준편차를 알 때처럼 <u>68-95 법칙을 활용</u>해 볼 수 있다



<img src="https://i.ibb.co/zmwgfrc/image.png" alt="image" border="0">

산포도상의 점들 중 약 68%가 회귀직선으로부터 ±1RMSE만큼 떨어져 있는 두 직선 사이에 있다. 약 95%의 점들은 ±2RMSE만큼 떨어져 있는 두 직선 사이에 존재한다.

 <br/>

**회귀직선의 RMSE와 y의 표준편차**

- 일반적으로 '회귀직선의 RMSE < y의 표준편차' 이는 수평선보다 회귀직선이 산포도 상의 점들에 보다 가까이 위치하기 때문이다
- 회귀직선의 RMSE는 대략 √(1-r²) * SDy와 같다. (단, r은 x와 y의 상관계수)

<br/>

**상관계수와 회귀직선의 RMSE**

- r = 1 인 경우
  - 산포도상의 모든 점들이 하나의 우상향하는 직선 위에 놓임
  - 추정오차는 모두 0, RMSE=0
- r = -1 인 경우
  - 산포도상의 모든 점들이 하나의 우하향하는 직선 위에 놓임
  - 추정오차는 모두 0, RMSE=0
- r = 0 인 경우
  - 두 변수 x와y간에 선형관계가 전혀 없음
  - 회귀직선은 x값으로 부터 y값을 추정하는 데 전혀 도움이 안됨
  - RMSE는 SDy와 대략 같은 값을 갖게 된다.

<br/>

- 등분산성 : 회귀직선을 중심으로 점들이 위 아래로 퍼진 정도

- 이분산성 : 오차항의 분산이 회귀모형에 포함되는 변수에 따라 일정하지 않게 나타나는 오차항에 있어서의 체계적 패턴현상

<br/>

# 4.2 회귀직선

- 절편 : x가 0일 때 y값을 의미

- 기울기 : x가 1만큼 증가할 때 y가 증가하는 정도를 의미

<br/>

**기울기 추정치에 대한 해석상의 주의**

통제된 실험으로부터 얻은 자료로 해석할 때는 추정된 기울기를 '외부개입 - 내부반응'으로 해석 가능하나, 경험적 연구로 얻은 기울기면 꼭 그런 것은 아니다.

<br/>

- 최소자승직선 : 모든 직선 중에서 x를 통해 y를 추정할 때 발생하는 추정오차들의 "제곱의 합"으로 측정한 전반적 크기를 가장 작게 만들어주는 직선
  - 산포도상의 각각의 점으로부터 하나의 직선까지의 수직거리를 정의
  - 수직거리의 "제곱 합"이 최소화 되는 직선을 회귀직선으로 선택
  - 수직거리의 제곱합을 최소화하는 것이나 RMS로 측정한 수직거리의 전반적 크기를 최소화하는 것이나 수학적으로 동일한 최적화 문제임
  - 즉, 최소자승법은 모든 직선 가운데 수직거리의 전반적 크기를 최소화 해주는 직선을 구하는 방법임

<br/>

- 중회귀분석 : 종종 제3의 변수가 두 변수 x와 y 각각에 영향을 미쳐, 관심의 대상인 두 변수 상호간의 순수한 관계를 왜곡시키게 됨. <u>제3의 변수를 통제할 필요성</u> 대두

<br/>

# 4.3 중회귀분석의 응용

<img src="https://i.ibb.co/5WWC418/image.png" alt="image" border="0">

- SST(총 제곱합) : y의 평균 주위로의 총변동
- SSR(회귀제곱합) : 회귀직선에 의해 설명되는 변동분
- SSE(잔차제곱합 or 오차제곱합) : 회귀직선에 의해 설명되지 않는 변동분